-- Create database and schema
CREATE OR REPLACE DATABASE travel_intelligence;
CREATE OR REPLACE SCHEMA travel_intelligence.data;

USE DATABASE travel_intelligence;
USE SCHEMA data;

-- Create tables for travel data
CREATE TABLE travel_reviews (
    review_id VARCHAR,
    review_text TEXT,
    customer_name VARCHAR,
    destination VARCHAR,
    hotel_name VARCHAR,
    review_date TIMESTAMP,
    rating FLOAT,
    trip_type VARCHAR
);

CREATE TABLE booking_metrics (
    booking_id VARCHAR,
    customer_name VARCHAR,
    booking_value FLOAT,
    travel_date DATE,
    booking_status VARCHAR,
    is_cancelled BOOLEAN,
    travel_agent VARCHAR,
    trip_type VARCHAR
);

-- Insert data into travel_reviews with Japanese content
INSERT INTO travel_reviews 
(review_id, review_text, customer_name, destination, hotel_name, review_date, rating, trip_type)
VALUES
('REV001', '沖縄の「サンセットリゾート石垣島」での滞在は素晴らしかったです。部屋からのエメラルドグリーンの海の眺めは息をのむほど美しく、プライベートビーチへの直接アクセスが最高でした。スタッフの対応も非常に丁寧で、特にフロントの佐藤さんには地元の隠れた名所を教えていただき感謝しています。リゾート内のレストランでは新鮮な海鮮料理が楽しめ、特に夕食時の日本酒の種類の豊富さに驚きました。マリンアクティビティも充実しており、シュノーケリングでは色とりどりのサンゴと熱帯魚を間近で見ることができました。唯一の不満点は、ピーク時のプールエリアが少し混雑していたことですが、早朝や夕方は比較的空いていました。家族連れやカップルにぴったりのリゾートで、ぜひまた訪れたいと思います。', '田中 雅彦', '沖縄', 'サンセットリゾート石垣島', '2024-01-15 10:30:00', 4.8, '家族旅行'),

('REV002', '京都「古都の宿 嵐山」での3泊の滞在は、期待と少し異なる体験でした。伝統的な和室と庭園の景観は確かに美しく、朝食の京懐石料理も本格的で美味しかったです。しかし、施設の一部が古く、特に浴室は更新が必要だと感じました。また、繁忙期だったためか、接客がやや機械的で個人的な温かみに欠ける印象を受けました。立地は嵐山の観光スポットへのアクセスが良く、特に竹林への散歩道は素晴らしかったです。夕食は近くの居酒屋を探索し、地元の方と交流できたのが良い思い出です。Wi-Fiの接続が部屋によって不安定だったのも改善点です。総合的には満足できる滞在でしたが、価格を考えるともう少しサービスの質を上げてほしいと思いました。', '佐藤 恵子', '京都', '古都の宿 嵐山', '2024-01-16 14:45:00', 3.5, 'カルチャーツアー'),

('REV003', '北海道「雪国グランドホテル」での冬季滞在は最高の体験でした！部屋から見える雪景色が絵画のように美しく、大浴場からの夜景も格別でした。スキーリゾートへの無料シャトルバスが便利で、ホテルのレンタル用品も質が良く、初心者の私たちにもスタッフが丁寧に使い方を教えてくれました。夕食バイキングでは北海道の新鮮な食材を使った料理が豊富で、特にカニとジンギスカンが絶品でした。子供向けの雪遊びプログラムもあり、息子は大喜びでした。客室は広く清潔で、床暖房が寒い季節にとても快適でした。スパ施設も充実しており、スキーの疲れを癒すのに最適でした。スタッフ全員が笑顔で対応してくれ、特にコンシェルジュの山田さんには地元ならではの体験を多く紹介していただきました。冬の北海道旅行には絶対おすすめのホテルです！', '伊藤 健太', '北海道', '雪国グランドホテル', '2024-01-17 11:20:00', 5.0, 'ウィンターリゾート'),

('REV004', '東京「メトロポリタンタワーホテル」でのビジネス滞在は効率的で快適でした。空港からのアクセスが良く、チェックインも迅速でした。ビジネスセンターの設備が充実しており、急な会議資料の印刷にも対応できました。部屋は機能的で、デスクスペースが広く、照明も作業に適していました。朝食ビュッフェは種類が豊富で、特に和食メニューのクオリティが高かったです。フィットネスセンターは24時間利用可能で、出張中の運動不足解消に役立ちました。部屋の防音性も良く、繁華街に近いにも関わらず静かに休むことができました。唯一の不満点は、ルームサービスのメニューがやや限られていたことです。総合的には、ビジネス目的の滞在に最適なホテルで、次回の東京出張でも利用したいと思います。', '鈴木 大輔', '東京', 'メトロポリタンタワーホテル', '2024-01-18 09:15:00', 4.5, 'ビジネス'),

('REV005', '福岡「博多ベイサイドホテル」での滞在は期待以上でした。最近リノベーションされたという客室は、モダンで清潔感があり、特にベッドの寝心地が素晴らしかったです。朝食で出された明太子と新鮮な魚介類を使った料理が印象的で、地元の味を堪能できました。ホテルのスタッフは皆さん親切で、特にフロントの中村さんには観光スポットや地元の美味しい飲食店を詳しく教えていただきました。立地も抜群で、博多駅から徒歩圏内なのに、部屋からは静かな海の景色が楽しめました。屋上テラスからの夕日も格別でした。館内のバーでは地元の焼酎やクラフトビールが楽しめ、夜のリラックスタイムに最適でした。価格も手頃で、コストパフォーマンスが非常に高いと感じました。福岡旅行には絶対におすすめのホテルです。', '山田 美咲', '福岡', '博多ベイサイドホテル', '2024-01-19 13:30:00', 4.7, '都市観光'),

('REV006', '長野「信州温泉旅館 森の雫」での滞在は、日常から完全に離れてリラックスするのに最適でした。100年以上の歴史を持つ建物は風情があり、所々に見られる伝統工芸品のディスプレイも魅力的でした。温泉は源泉かけ流しで、露天風呂からの山の景色が絶景でした。特に雪が降った翌朝の風景は忘れられません。夕食は個室で提供され、地元の食材を使った会席料理は見た目も味も素晴らしく、特に信州牛の石焼きと山菜の天ぷらが絶品でした。仲居さんの細やかなサービスと地元の歴史についての知識も深く、会話を楽しみました。客室は十分な広さがあり、和の雰囲気を大切にしながらも必要な現代的な設備が整っていました。朝の散歩コースも整備されており、清々しい空気の中での散策が気持ち良かったです。心身ともにリフレッシュできる、本物の日本旅館体験ができました。', '高橋 裕子', '長野', '信州温泉旅館 森の雫', '2024-01-20 15:45:00', 4.9, '温泉旅行'),

('REV007', '沖縄「コーラルリーフリゾート宮古島」での新婚旅行は、一生の思い出になりました。部屋から一歩出ればそこは白い砂浜で、透明度抜群の海が広がっていました。スイートルームは広々として清潔、バルコニーからの夕日が特に美しかったです。リゾート内のレストランでは沖縄料理と国際料理の両方が楽しめ、特に地元の食材を使ったイタリアンフュージョン料理が印象的でした。スパでのカップルマッサージは、旅の疲れを癒すのに最適でした。マリンアクティビティも充実しており、シュノーケリングツアーでは珍しいウミガメと一緒に泳ぐことができました。スタッフは皆さん笑顔で対応してくれ、特別な記念日ということで部屋にシャンパンとフルーツバスケットを用意してくれたサプライズには感動しました。ただ、レストランの予約が取りにくかったのが少し残念でした。それでも総合的には最高のリゾート体験で、記念日旅行に最適です。', '中村 健太', '沖縄', 'コーラルリーフリゾート宮古島', '2024-01-21 10:00:00', 4.8, '新婚旅行'),

('REV008', '北海道「ファームステイ十勝」での農業体験は、都会の喧騒を忘れさせてくれる素晴らしい経験でした。宿泊施設は元々農家の家屋を改装したもので、古き良き日本の田舎家の雰囲気を味わえました。オーナーの木村さん夫妻が温かく迎えてくれ、地元の歴史や農業について多くのことを学びました。朝は新鮮な卵を自分で採取し、それを使った朝食は格別でした。日中は野菜の収穫や乳牛の世話を体験し、子供たちは特に動物たちとの触れ合いを楽しんでいました。夕食は自分たちが収穫した野菜を使ったバーベキューで、星空の下での食事は忘れられない思い出です。施設は決して豪華ではありませんが、清潔で必要なものは揃っており、自然と共に過ごす本当の贅沢を感じました。Wi-Fiは弱かったですが、それも都会から離れる良い機会になりました。家族で本物の農業体験を求める方には、心からおすすめできる場所です。', '小林 家族', '北海道', 'ファームステイ十勝', '2024-01-22 14:20:00', 4.6, '体験型旅行'),

('REV009', '奈良「古都の宿 飛鳥」での滞在は、日本の歴史と文化を深く体験できる素晴らしいものでした。1300年以上の歴史を持つ寺院の敷地内に位置するこの宿は、静寂と厳かな雰囲気に包まれていました。部屋は最小限の家具で飾られた禅スタイルで、窓からは手入れの行き届いた日本庭園が見えました。朝5時からの朝のお勤めに参加し、その後の精進料理の朝食は心身ともに清められる体験でした。夕食も精進料理でしたが、野菜や豆腐を使った料理の繊細な味わいに感動しました。館内では書道や座禅の体験プログラムがあり、特に住職による仏教の教えについての講話が印象的でした。客室には現代的な設備はほとんどなく、テレビやWi-Fiもありませんが、それが逆に現代社会から離れて内省する貴重な時間となりました。静かな環境で自分自身と向き合いたい方、日本の伝統文化に興味がある方には特におすすめです。', '渡辺 哲也', '奈良', '古都の宿 飛鳥', '2024-01-23 16:30:00', 4.7, '文化体験'),

('REV010', '静岡「富士見テラス」での滞在は、景観と料理の両方で感動的な体験でした。部屋からの富士山の眺めは息をのむほど美しく、晴れた朝に目覚めて窓から見た富士山のシルエットは一生の宝物です。客室はモダンな和洋折衷スタイルで、特に檜風呂からも富士山が見えるという贅沢な設計でした。夕食は地元の食材を使った懐石料理で、特に静岡の海の幸と山の幸を融合させた創作料理は芸術品のようでした。朝食も部屋食で、地元の新鮮な野菜と卵を使った料理が美味しかったです。温泉は源泉かけ流しで、夜の星空を見ながらの入浴は格別でした。スタッフの方々も親切で、特に仲居さんの細やかな気配りが心地よかったです。館内には季節の花や伝統工芸品が飾られ、日本の美意識を感じられました。価格は高めですが、特別な記念日や贅沢な休暇にはぜひ訪れる価値があります。', '木村 直子', '静岡', '富士見テラス', '2024-01-24 11:45:00', 4.9, '高級旅行');

-- Now, let's insert corresponding data into booking_metrics
INSERT INTO booking_metrics 
(booking_id, customer_name, booking_value, travel_date, booking_status, is_cancelled, travel_agent, trip_type)
VALUES
('BOOK001', '田中 雅彦', 150000, '2024-02-15', '確定', false, '山本 旅行代理店', '家族旅行'),

('BOOK002', '佐藤 恵子', 85000, '2024-02-01', 'キャンセル', true, '日本トラベル', 'カルチャーツアー'),

('BOOK003', '伊藤 健太', 220000, '2024-01-30', '確定', false, '雪国エクスプレス', 'ウィンターリゾート'),

('BOOK004', '鈴木 大輔', 65000, '2024-02-10', '保留中', false, 'ビジネストラベル株式会社', 'ビジネス'),

('BOOK005', '山田 美咲', 95000, '2024-02-05', '確定', false, '福岡ツーリスト', '都市観光'),

('BOOK006', '高橋 裕子', 180000, '2024-02-20', '保留中', false, '温泉めぐり', '温泉旅行'),

('BOOK007', '中村 健太', 350000, '2024-01-25', '確定', false, 'ハネムーンスペシャリスト', '新婚旅行'),

('BOOK008', '小林 家族', 120000, '2024-02-08', '確定', false, '北海道エクスペリエンス', '体験型旅行'),

('BOOK009', '渡辺 哲也', 75000, '2024-02-12', '確定', false, '古都めぐり', '文化体験'),

('BOOK010', '木村 直子', 280000, '2024-02-18', '保留中', false, 'プレミアムジャパン', '高級旅行'),
-- 家族旅行の追加データ
('BOOK011', '吉田 康介', 165000, '2024-02-22', '確定', false, '山本 旅行代理店', '家族旅行'),
('BOOK012', '加藤 真理', 142000, '2024-02-25', '確定', false, 'ファミリートラベル', '家族旅行'),
('BOOK013', '松本 大輔', 198000, '2024-03-01', '確定', false, '日本ツーリスト', '家族旅行'),
('BOOK014', '井上 直樹', 175000, '2024-03-05', 'キャンセル', true, '山本 旅行代理店', '家族旅行'),
('BOOK015', '佐々木 美咲', 155000, '2024-03-10', '確定', false, 'ファミリートラベル', '家族旅行'),
('BOOK016', '山口 健一', 168000, '2024-03-15', 'キャンセル', true, '日本ツーリスト', '家族旅行'),
('BOOK017', '中島 裕子', 182000, '2024-03-20', '確定', false, '山本 旅行代理店', '家族旅行'),
('BOOK018', '岡田 拓也', 195000, '2024-03-25', '確定', false, 'ファミリートラベル', '家族旅行'),
('BOOK019', '後藤 明美', 159000, '2024-04-01', 'キャンセル', true, '日本ツーリスト', '家族旅行'),
('BOOK020', '村田 健太', 172000, '2024-04-05', '確定', false, '山本 旅行代理店', '家族旅行'),

-- ビジネス旅行の追加データ
('BOOK021', '田村 隆', 58000, '2024-02-22', '確定', false, 'ビジネストラベル株式会社', 'ビジネス旅行'),
('BOOK022', '西村 直子', 62000, '2024-02-25', 'キャンセル', true, 'エグゼクティブトラベル', 'ビジネス旅行'),
('BOOK023', '斎藤 健', 71000, '2024-03-01', '確定', false, 'ビジネストラベル株式会社', 'ビジネス旅行'),
('BOOK024', '上田 真由美', 59000, '2024-03-05', '確定', false, 'エグゼクティブトラベル', 'ビジネス旅行'),
('BOOK025', '原田 哲也', 68000, '2024-03-10', 'キャンセル', true, 'ビジネストラベル株式会社', 'ビジネス旅行'),
('BOOK026', '藤田 恵美', 63000, '2024-03-15', '確定', false, 'エグゼクティブトラベル', 'ビジネス旅行'),
('BOOK027', '小川 拓也', 72000, '2024-03-20', 'キャンセル', true, 'ビジネストラベル株式会社', 'ビジネス旅行'),
('BOOK028', '長谷川 美香', 67000, '2024-03-25', '確定', false, 'エグゼクティブトラベル', 'ビジネス旅行'),
('BOOK029', '石田 浩二', 61000, '2024-04-01', 'キャンセル', true, 'ビジネストラベル株式会社', 'ビジネス旅行'),
('BOOK030', '山本 由美', 69000, '2024-04-05', '確定', false, 'エグゼクティブトラベル', 'ビジネス旅行'),

-- カルチャーツアーの追加データ
('BOOK031', '近藤 隆史', 92000, '2024-02-22', '確定', false, '日本トラベル', 'カルチャーツアー'),
('BOOK032', '遠藤 香織', 88000, '2024-02-25', 'キャンセル', true, '古都めぐり', 'カルチャーツアー'),
('BOOK033', '青木 誠', 95000, '2024-03-01', 'キャンセル', true, '日本トラベル', 'カルチャーツアー'),
('BOOK034', '福田 美穂', 87000, '2024-03-05', '確定', false, '古都めぐり', 'カルチャーツアー'),
('BOOK035', '松田 健太郎', 93000, '2024-03-10', '確定', false, '日本トラベル', 'カルチャーツアー'),

-- 温泉旅行の追加データ
('BOOK036', '杉山 洋子', 175000, '2024-02-22', '確定', false, '温泉めぐり', '温泉旅行'),
('BOOK037', '野村 達也', 185000, '2024-02-25', '確定', false, '湯めぐり紀行', '温泉旅行'),
('BOOK038', '木下 真紀', 172000, '2024-03-01', 'キャンセル', true, '温泉めぐり', '温泉旅行'),
('BOOK039', '菊地 健一', 188000, '2024-03-05', '確定', false, '湯めぐり紀行', '温泉旅行'),
('BOOK040', '岩崎 恵子', 179000, '2024-03-10', '確定', false, '温泉めぐり', '温泉旅行'),

-- 新婚旅行の追加データ
('BOOK041', '三浦 大輔', 320000, '2024-02-22', '確定', false, 'ハネムーンスペシャリスト', '新婚旅行'),
('BOOK042', '中野 美咲', 345000, '2024-02-25', '確定', false, 'ウェディングトラベル', '新婚旅行'),
('BOOK043', '川村 拓也', 380000, '2024-03-01', 'キャンセル', true, 'ハネムーンスペシャリスト', '新婚旅行'),
('BOOK044', '林 恵梨子', 335000, '2024-03-05', '確定', false, 'ウェディングトラベル', '新婚旅行'),
('BOOK045', '横山 裕太', 365000, '2024-03-10', '確定', false, 'ハネムーンスペシャリスト', '新婚旅行'),

-- 体験型旅行の追加データ
('BOOK046', '星野 健太', 125000, '2024-02-22', '確定', false, '北海道エクスペリエンス', '体験型旅行'),
('BOOK047', '大塚 真理子', 118000, '2024-02-25', 'キャンセル', true, 'アドベンチャーツアー', '体験型旅行'),
('BOOK048', '本田 隆史', 132000, '2024-03-01', '確定', false, '北海道エクスペリエンス', '体験型旅行'),
('BOOK049', '今井 美香', 122000, '2024-03-05', 'キャンセル', true, 'アドベンチャーツアー', '体験型旅行'),
('BOOK050', '西田 浩二', 128000, '2024-03-10', '確定', false, '北海道エクスペリエンス', '体験型旅行'),

-- 文化体験の追加データ
('BOOK051', '竹内 智子', 82000, '2024-02-22', '確定', false, '古都めぐり', '文化体験'),
('BOOK052', '内田 正人', 78000, '2024-02-25', 'キャンセル', true, '伝統文化ツアー', '文化体験'),
('BOOK053', '高木 裕美', 85000, '2024-03-01', '確定', false, '古都めぐり', '文化体験'),
('BOOK054', '安藤 健太', 79000, '2024-03-05', '確定', false, '伝統文化ツアー', '文化体験'),
('BOOK055', '坂本 恵子', 83000, '2024-03-10', 'キャンセル', true, '古都めぐり', '文化体験'),

-- 高級旅行の追加データ
('BOOK056', '丸山 隆', 295000, '2024-02-22', '確定', false, 'プレミアムジャパン', '高級旅行'),
('BOOK057', '小島 真理', 310000, '2024-02-25', '確定', false, 'ラグジュアリートラベル', '高級旅行'),
('BOOK058', '浜田 健一', 325000, '2024-03-01', 'キャンセル', true, 'プレミアムジャパン', '高級旅行'),
('BOOK059', '平野 美咲', 302000, '2024-03-05', '確定', false, 'ラグジュアリートラベル', '高級旅行'),
('BOOK060', '大西 拓也', 318000, '2024-03-10', '確定', false, 'プレミアムジャパン', '高級旅行'),

-- 都市観光の追加データ
('BOOK061', '藤井 恵子', 98000, '2024-02-22', '確定', false, '福岡ツーリスト', '都市観光'),
('BOOK062', '村上 健太', 92000, '2024-02-25', 'キャンセル', true, 'シティエクスプローラー', '都市観光'),
('BOOK063', '太田 真由美', 105000, '2024-03-01', '確定', false, '福岡ツーリスト', '都市観光'),
('BOOK064', '中山 隆史', 97000, '2024-03-05', '確定', false, 'シティエクスプローラー', '都市観光'),
('BOOK065', '石川 香織', 103000, '2024-03-10', 'キャンセル', true, '福岡ツーリスト', '都市観光'),

-- ウィンターリゾートの追加データ
('BOOK066', '前田 大輔', 215000, '2024-02-22', '確定', false, '雪国エクスプレス', 'ウィンターリゾート'),
('BOOK067', '柴田 美穂', 225000, '2024-02-25', 'キャンセル', true, 'スキーリゾートツアー', 'ウィンターリゾート'),
('BOOK068', '酒井 健太郎', 235000, '2024-03-01', '確定', false, '雪国エクスプレス', 'ウィンターリゾート'),
('BOOK069', '工藤 恵美', 218000, '2024-03-05', 'キャンセル', true, 'スキーリゾートツアー', 'ウィンターリゾート'),
('BOOK070', '横田 隆', 228000, '2024-03-10', '確定', false, '雪国エクスプレス', 'ウィンターリゾート');

-- Enable change tracking
ALTER TABLE travel_reviews SET CHANGE_TRACKING = TRUE;

-- Create the search service
CREATE OR REPLACE CORTEX SEARCH SERVICE travel_review_search
  ON review_text
  ATTRIBUTES customer_name, destination, hotel_name, review_date, rating, trip_type
  WAREHOUSE = compute_wh
  TARGET_LAG = '1 minute'
  AS (
    SELECT
        review_id,
        review_text,
        customer_name,
        destination,
        hotel_name,
        review_date,
        rating,
        trip_type
    FROM travel_reviews
    WHERE review_date >= '2024-01-01'
);

CREATE OR REPLACE STAGE models 
    DIRECTORY = (ENABLE = TRUE);
